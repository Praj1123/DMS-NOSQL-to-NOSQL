2025-07-19 09:49:21,632 - migrate - INFO - === MongoDB Migration Tool Starting ===
2025-07-19 09:49:21,637 - migrate - INFO - Validating source database connection...
2025-07-19 09:49:50,979 - migrate - ERROR - Database connection validation failed: localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 30000.0ms, connectTimeoutMS: 30000.0ms), Timeout: 30.0s, Topology Description: <TopologyDescription id: 687b6a21374733bfdc00c217, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 30000.0ms, connectTimeoutMS: 30000.0ms)')>]>
2025-07-19 09:49:51,000 - migrate - ERROR - Connection validation failed. Exiting.
2025-07-19 09:53:53,904 - migrate - INFO - === MongoDB Migration Tool Starting ===
2025-07-19 09:53:53,906 - migrate - INFO - Validating source database connection...
2025-07-19 09:54:23,860 - migrate - ERROR - Database connection validation failed: localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 30000.0ms, connectTimeoutMS: 30000.0ms), Timeout: 30.0s, Topology Description: <TopologyDescription id: 687b6b31ba7d789b197b7cc3, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 30000.0ms, connectTimeoutMS: 30000.0ms)')>]>
2025-07-19 09:54:23,862 - migrate - ERROR - Connection validation failed. Exiting.
2025-07-19 09:56:47,322 - migrate - INFO - === MongoDB Migration Tool Starting ===
2025-07-19 09:56:47,323 - migrate - INFO - Validating source database connection...
2025-07-19 09:57:16,830 - migrate - ERROR - Database connection validation failed: 172.31.17.41:27017: timed out (configured timeouts: socketTimeoutMS: 30000.0ms, connectTimeoutMS: 30000.0ms), Timeout: 30.0s, Topology Description: <TopologyDescription id: 687b6bdf8edd1010758dd4ae, topology_type: Unknown, servers: [<ServerDescription ('172.31.17.41', 27017) server_type: Unknown, rtt: None, error=NetworkTimeout('172.31.17.41:27017: timed out (configured timeouts: socketTimeoutMS: 30000.0ms, connectTimeoutMS: 30000.0ms)')>]>
2025-07-19 09:57:16,832 - migrate - ERROR - Connection validation failed. Exiting.
2025-07-19 10:00:19,033 - migrate - INFO - === MongoDB Migration Tool Starting ===
2025-07-19 10:00:19,034 - migrate - INFO - Validating source database connection...
2025-07-19 10:01:17,420 - migrate - ERROR - Database connection validation failed: No servers found yet, Timeout: 60.0s, Topology Description: <TopologyDescription id: 687b6cb301bcbc65e17c1b70, topology_type: Unknown, servers: [<ServerDescription ('172.31.17.41', 27017) server_type: Unknown, rtt: None>]>
2025-07-19 10:01:17,423 - migrate - ERROR - Connection validation failed. Exiting.
2025-07-19 10:02:30,077 - migrate - INFO - === MongoDB Migration Tool Starting ===
2025-07-19 10:02:30,078 - migrate - INFO - Validating source database connection...
2025-07-19 10:03:29,523 - migrate - ERROR - Database connection validation failed: 172.31.17.41:27017: timed out (configured timeouts: socketTimeoutMS: 60000.0ms, connectTimeoutMS: 60000.0ms), Timeout: 60.0s, Topology Description: <TopologyDescription id: 687b6d36fad95bd51bb86ac3, topology_type: Unknown, servers: [<ServerDescription ('172.31.17.41', 27017) server_type: Unknown, rtt: None, error=NetworkTimeout('172.31.17.41:27017: timed out (configured timeouts: socketTimeoutMS: 60000.0ms, connectTimeoutMS: 60000.0ms)')>]>
2025-07-19 10:03:29,525 - migrate - ERROR - Connection validation failed. Exiting.
2025-07-19 10:08:16,424 - migrate - INFO - === MongoDB Migration Tool Starting ===
2025-07-19 10:08:16,426 - migrate - INFO - Validating source database connection...
2025-07-19 10:08:40,522 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 10:08:42,039 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 10:08:42,914 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 10:08:43,331 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 10:08:43,556 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 10:08:43,761 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 10:08:43,981 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 10:08:54,098 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 10:08:54,296 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 10:08:54,449 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 10:08:54,615 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 10:08:54,763 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 10:08:54,903 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 10:13:42,916 - migrate - INFO - === MongoDB Migration Tool Starting ===
2025-07-19 10:13:42,918 - migrate - INFO - Validating source database connection...
2025-07-19 10:15:04,640 - migrate - INFO - === MongoDB Migration Tool Starting ===
2025-07-19 10:15:04,642 - migrate - INFO - Validating source database connection...
2025-07-19 10:16:04,143 - migrate - ERROR - Database connection validation failed: localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 60000.0ms, connectTimeoutMS: 60000.0ms), Timeout: 60.0s, Topology Description: <TopologyDescription id: 687b70286b3fd03ac96fd5b6, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 60000.0ms, connectTimeoutMS: 60000.0ms)')>]>
2025-07-19 10:16:04,145 - migrate - ERROR - Connection validation failed. Exiting.
2025-07-19 10:17:22,030 - migrate - INFO - === MongoDB Migration Tool Starting ===
2025-07-19 10:17:22,032 - migrate - INFO - Validating source database connection...
2025-07-19 10:17:24,446 - migrate - INFO - Validating target database connection...
2025-07-19 10:17:26,508 - migrate - INFO - Database connections validated successfully
2025-07-19 10:17:26,514 - migrate - INFO - Loaded 3 collections for migration
2025-07-19 10:17:26,520 - migrate - INFO - Starting migration with 4 workers
2025-07-19 10:17:26,526 - migrate - INFO - Starting migration for users
2025-07-19 10:17:26,527 - migrate - INFO - Starting migration for orders
2025-07-19 10:17:26,529 - migrate - INFO - Starting migration for agents
2025-07-19 10:17:31,095 - migrate - INFO - Migration completed for users in 4.57 seconds
2025-07-19 10:17:31,585 - migrate - INFO - Migration completed for orders in 5.05 seconds
2025-07-19 10:17:31,586 - migrate - INFO - Migration completed for agents in 5.05 seconds
2025-07-19 10:17:31,588 - migrate - INFO - Migration complete. Success: 3, Failed: 0
2025-07-19 10:17:31,590 - migrate - INFO - Starting migration verification...
2025-07-19 10:17:37,009 - migrate - INFO - Verification MISMATCH for users: 0/0 documents (0.00%)
2025-07-19 10:17:38,131 - migrate - INFO - Verification MISMATCH for orders: 0/0 documents (0.00%)
2025-07-19 10:17:39,056 - migrate - INFO - Verification MISMATCH for agents: 0/0 documents (0.00%)
2025-07-19 10:17:39,063 - migrate - WARNING - 3 collections failed verification
2025-07-19 10:19:07,271 - migrate - INFO - === MongoDB Migration Tool Starting ===
2025-07-19 10:19:07,274 - migrate - INFO - Validating source database connection...
2025-07-19 10:19:09,764 - migrate - INFO - Validating target database connection...
2025-07-19 10:19:12,289 - migrate - INFO - Database connections validated successfully
2025-07-19 10:19:12,295 - migrate - INFO - Loaded 3 collections for migration
2025-07-19 10:19:12,300 - migrate - INFO - Starting migration with 4 workers
2025-07-19 10:19:12,303 - migrate - INFO - Starting migration for users
2025-07-19 10:19:12,303 - migrate - INFO - Starting migration for orders
2025-07-19 10:19:12,304 - migrate - INFO - Starting migration for agents
2025-07-19 10:19:17,420 - migrate - INFO - Migration completed for orders in 5.11 seconds
2025-07-19 10:19:17,421 - migrate - INFO - Migration completed for agents in 5.11 seconds
2025-07-19 10:19:17,423 - migrate - INFO - Migration completed for users in 5.12 seconds
2025-07-19 10:19:17,425 - migrate - INFO - Migration complete. Success: 3, Failed: 0
2025-07-19 10:19:17,426 - migrate - INFO - Starting migration verification...
2025-07-19 10:19:20,876 - migrate - INFO - Verification MISMATCH for users: 0/0 documents (0.00%)
2025-07-19 10:19:21,495 - migrate - INFO - Verification MISMATCH for orders: 0/0 documents (0.00%)
2025-07-19 10:19:22,437 - migrate - INFO - Verification MISMATCH for agents: 0/0 documents (0.00%)
2025-07-19 10:19:22,447 - migrate - WARNING - 3 collections failed verification
2025-07-19 10:26:32,464 - migrate - INFO - === MongoDB Migration Tool Starting ===
2025-07-19 10:26:32,466 - migrate - INFO - Validating source database connection...
2025-07-19 10:26:35,572 - migrate - INFO - Validating target database connection...
2025-07-19 10:26:38,819 - migrate - INFO - Database connections validated successfully
2025-07-19 10:26:38,824 - migrate - INFO - Loaded 3 collections for migration
2025-07-19 10:26:38,828 - migrate - INFO - Starting migration with 4 workers
2025-07-19 10:26:38,832 - migrate - INFO - Starting migration for users
2025-07-19 10:26:38,833 - migrate - INFO - Starting migration for orders
2025-07-19 10:26:38,838 - migrate - INFO - Starting migration for agents
2025-07-19 10:26:46,601 - migrate - ERROR - Migration failed for users: Object of type ObjectId is not JSON serializable
Traceback (most recent call last):
  File "/mnt/c/Users/prajw/Downloads/mongo_migration/mongo_migration/migrate.py", line 77, in run_job
    migrate_collection(c["source_db"], c["target_db"], c["collection"])
  File "/mnt/c/Users/prajw/Downloads/mongo_migration/mongo_migration/workers/collection_worker.py", line 149, in migrate_collection
    verify_batch(docs, dest, collection_name)
  File "/mnt/c/Users/prajw/Downloads/mongo_migration/mongo_migration/workers/collection_worker.py", line 53, in verify_batch
    src_hash = hashlib.md5(json.dumps(src_doc, sort_keys=True).encode()).hexdigest()
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/json/__init__.py", line 238, in dumps
    **kw).encode(obj)
          ^^^^^^^^^^^
  File "/usr/lib/python3.12/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           ^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type ObjectId is not JSON serializable
2025-07-19 10:26:46,642 - migrate - ERROR - Migration failed for orders: Object of type ObjectId is not JSON serializable
Traceback (most recent call last):
  File "/mnt/c/Users/prajw/Downloads/mongo_migration/mongo_migration/migrate.py", line 77, in run_job
    migrate_collection(c["source_db"], c["target_db"], c["collection"])
  File "/mnt/c/Users/prajw/Downloads/mongo_migration/mongo_migration/workers/collection_worker.py", line 149, in migrate_collection
    verify_batch(docs, dest, collection_name)
  File "/mnt/c/Users/prajw/Downloads/mongo_migration/mongo_migration/workers/collection_worker.py", line 53, in verify_batch
    src_hash = hashlib.md5(json.dumps(src_doc, sort_keys=True).encode()).hexdigest()
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/json/__init__.py", line 238, in dumps
    **kw).encode(obj)
          ^^^^^^^^^^^
  File "/usr/lib/python3.12/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           ^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type ObjectId is not JSON serializable
2025-07-19 10:26:46,867 - migrate - ERROR - Migration failed for agents: Object of type ObjectId is not JSON serializable
Traceback (most recent call last):
  File "/mnt/c/Users/prajw/Downloads/mongo_migration/mongo_migration/migrate.py", line 77, in run_job
    migrate_collection(c["source_db"], c["target_db"], c["collection"])
  File "/mnt/c/Users/prajw/Downloads/mongo_migration/mongo_migration/workers/collection_worker.py", line 149, in migrate_collection
    verify_batch(docs, dest, collection_name)
  File "/mnt/c/Users/prajw/Downloads/mongo_migration/mongo_migration/workers/collection_worker.py", line 53, in verify_batch
    src_hash = hashlib.md5(json.dumps(src_doc, sort_keys=True).encode()).hexdigest()
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/json/__init__.py", line 238, in dumps
    **kw).encode(obj)
          ^^^^^^^^^^^
  File "/usr/lib/python3.12/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           ^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type ObjectId is not JSON serializable
2025-07-19 10:26:46,874 - migrate - INFO - Migration complete. Success: 0, Failed: 3
2025-07-19 10:26:46,876 - migrate - ERROR - Failed collections: [{'status': 'failed', 'collection': 'users', 'error': 'Object of type ObjectId is not JSON serializable'}, {'status': 'failed', 'collection': 'orders', 'error': 'Object of type ObjectId is not JSON serializable'}, {'status': 'failed', 'collection': 'agents', 'error': 'Object of type ObjectId is not JSON serializable'}]
2025-07-19 10:26:46,877 - migrate - INFO - Starting migration verification...
2025-07-19 10:26:50,624 - migrate - INFO - Verification OK for users: 2/2 documents (100.00%)
2025-07-19 10:26:51,316 - migrate - INFO - Verification OK for orders: 2/2 documents (100.00%)
2025-07-19 10:26:52,009 - migrate - INFO - Verification OK for agents: 2/2 documents (100.00%)
2025-07-19 10:26:52,020 - migrate - INFO - All collections verified successfully
2025-07-19 10:31:07,784 - migrate - INFO - === MongoDB Migration Tool Starting ===
2025-07-19 10:31:07,785 - migrate - INFO - Validating source database connection...
2025-07-19 10:31:10,569 - migrate - INFO - Validating target database connection...
2025-07-19 10:31:13,520 - migrate - INFO - Database connections validated successfully
2025-07-19 10:31:13,527 - migrate - INFO - Loaded 3 collections for migration
2025-07-19 10:31:13,532 - migrate - INFO - Starting migration with 4 workers
2025-07-19 10:31:13,535 - migrate - INFO - Starting migration for users
2025-07-19 10:31:13,538 - migrate - INFO - Starting migration for orders
2025-07-19 10:31:13,541 - migrate - INFO - Starting migration for agents
2025-07-19 10:31:22,106 - migrate - ERROR - Migration failed for users: '_id'
Traceback (most recent call last):
  File "/mnt/c/Users/prajw/Downloads/mongo_migration/mongo_migration/migrate.py", line 77, in run_job
    migrate_collection(c["source_db"], c["target_db"], c["collection"])
  File "/mnt/c/Users/prajw/Downloads/mongo_migration/mongo_migration/workers/collection_worker.py", line 170, in migrate_collection
    query["_id"]["$gt"] = last_id
    ~~~~~^^^^^^^
KeyError: '_id'
2025-07-19 10:31:22,280 - migrate - ERROR - Migration failed for agents: '_id'
Traceback (most recent call last):
  File "/mnt/c/Users/prajw/Downloads/mongo_migration/mongo_migration/migrate.py", line 77, in run_job
    migrate_collection(c["source_db"], c["target_db"], c["collection"])
  File "/mnt/c/Users/prajw/Downloads/mongo_migration/mongo_migration/workers/collection_worker.py", line 170, in migrate_collection
    query["_id"]["$gt"] = last_id
    ~~~~~^^^^^^^
KeyError: '_id'
2025-07-19 10:31:22,292 - migrate - ERROR - Migration failed for orders: '_id'
Traceback (most recent call last):
  File "/mnt/c/Users/prajw/Downloads/mongo_migration/mongo_migration/migrate.py", line 77, in run_job
    migrate_collection(c["source_db"], c["target_db"], c["collection"])
  File "/mnt/c/Users/prajw/Downloads/mongo_migration/mongo_migration/workers/collection_worker.py", line 170, in migrate_collection
    query["_id"]["$gt"] = last_id
    ~~~~~^^^^^^^
KeyError: '_id'
2025-07-19 10:31:22,297 - migrate - INFO - Migration complete. Success: 0, Failed: 3
2025-07-19 10:31:22,299 - migrate - ERROR - Failed collections: [{'status': 'failed', 'collection': 'users', 'error': "'_id'"}, {'status': 'failed', 'collection': 'agents', 'error': "'_id'"}, {'status': 'failed', 'collection': 'orders', 'error': "'_id'"}]
2025-07-19 10:31:22,300 - migrate - INFO - Starting migration verification...
2025-07-19 10:31:26,410 - migrate - INFO - Verification OK for users: 2/2 documents (100.00%)
2025-07-19 10:31:27,300 - migrate - INFO - Verification OK for orders: 2/2 documents (100.00%)
2025-07-19 10:31:28,300 - migrate - INFO - Verification OK for agents: 2/2 documents (100.00%)
2025-07-19 10:31:28,308 - migrate - INFO - All collections verified successfully
2025-07-19 10:32:34,501 - migrate - INFO - === MongoDB Migration Tool Starting ===
2025-07-19 10:32:34,502 - migrate - INFO - Validating source database connection...
2025-07-19 10:32:36,971 - migrate - INFO - Validating target database connection...
2025-07-19 10:32:39,233 - migrate - INFO - Database connections validated successfully
2025-07-19 10:32:39,238 - migrate - INFO - Loaded 3 collections for migration
2025-07-19 10:32:39,244 - migrate - INFO - Starting migration with 4 workers
2025-07-19 10:32:39,252 - migrate - INFO - Starting migration for users
2025-07-19 10:32:39,253 - migrate - INFO - Starting migration for orders
2025-07-19 10:32:39,253 - migrate - INFO - Starting migration for agents
2025-07-19 10:32:43,901 - migrate - INFO - Migration completed for agents in 4.64 seconds
2025-07-19 10:32:43,903 - migrate - INFO - Migration completed for orders in 4.65 seconds
2025-07-19 10:32:43,933 - migrate - INFO - Migration completed for users in 4.68 seconds
2025-07-19 10:32:43,934 - migrate - INFO - Migration complete. Success: 3, Failed: 0
2025-07-19 10:32:43,936 - migrate - INFO - Starting migration verification...
2025-07-19 10:32:47,362 - migrate - INFO - Verification OK for users: 2/2 documents (100.00%)
2025-07-19 10:32:48,017 - migrate - INFO - Verification OK for orders: 2/2 documents (100.00%)
2025-07-19 10:32:48,658 - migrate - INFO - Verification OK for agents: 2/2 documents (100.00%)
2025-07-19 10:32:48,666 - migrate - INFO - All collections verified successfully
2025-07-19 10:34:58,728 - migrate - INFO - === MongoDB Migration Tool Starting ===
2025-07-19 10:34:58,729 - migrate - INFO - Validating source database connection...
2025-07-19 10:35:01,075 - migrate - INFO - Validating target database connection...
2025-07-19 10:35:03,193 - migrate - INFO - Database connections validated successfully
2025-07-19 10:35:03,200 - migrate - INFO - Loaded 3 collections for migration
2025-07-19 10:35:03,206 - migrate - INFO - Starting CDC mode with real-time change streams for continuous synchronization
2025-07-19 10:38:32,896 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 10:38:33,722 - migrate - INFO - Signaling change stream threads to shut down
2025-07-19 10:38:33,724 - migrate - INFO - CDC mode stopped
2025-07-19 10:38:38,150 - migrate - INFO - === MongoDB Migration Tool Starting ===
2025-07-19 10:38:38,151 - migrate - INFO - Validating source database connection...
2025-07-19 10:38:40,635 - migrate - INFO - Validating target database connection...
2025-07-19 10:38:42,537 - migrate - INFO - Database connections validated successfully
2025-07-19 10:38:42,544 - migrate - INFO - Loaded 3 collections for migration
2025-07-19 10:38:42,550 - migrate - INFO - Starting CDC mode
2025-07-19 10:38:44,617 - migrate - WARNING - Change streams not supported: The $changeStream stage is only supported on replica sets, full error: {'ok': 0.0, 'errmsg': 'The $changeStream stage is only supported on replica sets', 'code': 40573, 'codeName': 'Location40573'}. Falling back to polling mode.
2025-07-19 10:38:44,620 - migrate - INFO - Starting legacy CDC mode with polling
2025-07-19 10:38:44,621 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 10:39:12,018 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 10:40:11,399 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 10:40:31,028 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 10:41:34,418 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 10:41:49,172 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 10:42:47,636 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 10:42:59,991 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 10:43:58,910 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 10:44:11,341 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 10:45:10,559 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 10:45:21,646 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 10:46:21,423 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 10:46:32,512 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 10:47:31,150 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 10:47:43,448 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 10:48:42,068 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 10:48:54,552 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 10:49:53,055 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 10:50:04,412 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 10:51:03,932 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 10:51:15,309 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 10:52:18,062 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 10:52:30,601 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 10:53:31,275 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 11:17:26,999 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 11:17:28,260 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 11:17:28,856 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 11:17:39,136 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 11:17:39,137 - migrate - INFO - CDC mode stopped
2025-07-19 11:17:39,138 - migrate - INFO - CDC mode stopped
2025-07-19 11:18:47,027 - migrate - INFO - === MongoDB Migration Tool Starting ===
2025-07-19 11:18:47,028 - migrate - INFO - Validating source database connection...
2025-07-19 11:18:48,936 - migrate - INFO - Validating target database connection...
2025-07-19 11:18:50,753 - migrate - INFO - Database connections validated successfully
2025-07-19 11:18:50,759 - migrate - INFO - Loaded 3 collections for migration
2025-07-19 11:18:50,766 - migrate - INFO - Starting CDC mode
2025-07-19 11:18:52,571 - migrate - WARNING - Change streams not supported: The $changeStream stage is only supported on replica sets, full error: {'ok': 0.0, 'errmsg': 'The $changeStream stage is only supported on replica sets', 'code': 40573, 'codeName': 'Location40573'}. Falling back to polling mode.
2025-07-19 11:18:52,572 - migrate - INFO - Starting legacy CDC mode with polling
2025-07-19 11:18:52,573 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 11:19:11,089 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 11:20:10,769 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 11:20:27,138 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 11:21:26,827 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 11:21:42,341 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 11:22:41,238 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 11:22:57,526 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 11:23:57,598 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 11:24:15,939 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 11:25:14,838 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 11:25:32,190 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 11:26:30,978 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 11:26:47,191 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 11:27:46,493 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 11:28:03,666 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 11:29:03,447 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 11:29:19,630 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 11:30:18,204 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 11:30:34,936 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 11:31:33,626 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 11:31:50,344 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 11:32:49,806 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 11:33:03,830 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 11:34:04,032 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 11:34:22,986 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 11:35:22,766 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 11:35:39,135 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 11:36:39,468 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 11:36:55,883 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 11:37:55,597 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 11:38:12,829 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 11:39:12,727 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 11:39:28,770 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 11:40:28,052 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 11:40:45,205 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 11:41:44,706 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 11:42:00,923 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 11:43:00,414 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 11:43:16,247 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 11:44:16,952 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 11:44:33,014 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 11:45:32,957 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 11:45:49,796 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 11:46:49,444 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 11:47:05,593 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 11:48:05,078 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 11:48:25,528 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 11:49:24,119 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 11:49:43,105 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 11:50:41,784 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 11:50:58,029 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 11:51:57,422 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 11:52:14,025 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 11:53:13,363 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 11:54:05,600 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 11:55:04,211 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 11:55:49,461 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 11:56:48,902 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 11:57:44,257 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 11:58:43,070 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 11:59:24,073 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 11:59:28,365 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 11:59:28,366 - migrate - INFO - CDC mode stopped
2025-07-19 11:59:28,368 - migrate - INFO - CDC mode stopped
2025-07-19 11:59:34,031 - migrate - INFO - === MongoDB Migration Tool Starting ===
2025-07-19 11:59:34,032 - migrate - INFO - Validating source database connection...
2025-07-19 11:59:34,982 - migrate - INFO - Validating target database connection...
2025-07-19 11:59:36,896 - migrate - INFO - Database connections validated successfully
2025-07-19 11:59:36,900 - migrate - INFO - Loaded 3 collections for migration
2025-07-19 11:59:36,905 - migrate - INFO - Starting CDC mode
2025-07-19 11:59:38,820 - migrate - WARNING - Change streams not supported: The $changeStream stage is only supported on replica sets, full error: {'ok': 0.0, 'errmsg': 'The $changeStream stage is only supported on replica sets', 'code': 40573, 'codeName': 'Location40573'}. Falling back to polling mode.
2025-07-19 11:59:38,822 - migrate - INFO - Starting legacy CDC mode with polling
2025-07-19 11:59:38,823 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 11:59:52,578 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 12:00:15,906 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 12:00:20,594 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 12:00:21,004 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 12:00:21,424 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 12:00:21,810 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 12:00:22,190 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 12:00:25,140 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 12:00:25,141 - migrate - INFO - CDC mode stopped
2025-07-19 12:00:25,142 - migrate - INFO - CDC mode stopped
2025-07-19 12:00:35,393 - migrate - INFO - === MongoDB Migration Tool Starting ===
2025-07-19 12:00:35,394 - migrate - INFO - Validating source database connection...
2025-07-19 12:00:37,375 - migrate - INFO - Validating target database connection...
2025-07-19 12:00:38,188 - migrate - INFO - Database connections validated successfully
2025-07-19 12:00:38,194 - migrate - INFO - Loaded 3 collections for migration
2025-07-19 12:00:38,201 - migrate - INFO - Starting migration with 4 workers
2025-07-19 12:00:38,205 - migrate - INFO - Starting migration for users
2025-07-19 12:00:38,206 - migrate - INFO - Starting migration for orders
2025-07-19 12:00:38,209 - migrate - INFO - Starting migration for agents
2025-07-19 12:00:42,589 - migrate - INFO - Migration completed for agents in 4.37 seconds
2025-07-19 12:00:43,573 - migrate - INFO - Migration completed for orders in 5.36 seconds
2025-07-19 12:00:50,120 - migrate - INFO - Migration completed for users in 11.91 seconds
2025-07-19 12:00:50,122 - migrate - INFO - Migration complete. Success: 3, Failed: 0
2025-07-19 12:00:50,123 - migrate - INFO - Starting migration verification...
2025-07-19 12:00:53,255 - migrate - INFO - Verification OK for users: 1100/1100 documents (100.00%)
2025-07-19 12:00:53,881 - migrate - INFO - Verification OK for orders: 4/4 documents (100.00%)
2025-07-19 12:00:54,504 - migrate - INFO - Verification OK for agents: 2/2 documents (100.00%)
2025-07-19 12:00:54,512 - migrate - INFO - All collections verified successfully
2025-07-19 12:02:15,981 - migrate - INFO - === MongoDB Migration Tool Starting ===
2025-07-19 12:02:15,983 - migrate - INFO - Validating source database connection...
2025-07-19 12:02:18,024 - migrate - INFO - Validating target database connection...
2025-07-19 12:02:19,935 - migrate - INFO - Database connections validated successfully
2025-07-19 12:02:19,940 - migrate - INFO - Loaded 3 collections for migration
2025-07-19 12:02:19,945 - migrate - INFO - Starting migration with 4 workers
2025-07-19 12:02:19,950 - migrate - INFO - Starting migration for users
2025-07-19 12:02:19,951 - migrate - INFO - Starting migration for orders
2025-07-19 12:02:19,953 - migrate - INFO - Starting migration for agents
2025-07-19 12:02:24,427 - migrate - INFO - Migration completed for agents in 4.47 seconds
2025-07-19 12:02:24,480 - migrate - INFO - Migration completed for users in 4.53 seconds
2025-07-19 12:02:29,797 - migrate - INFO - Migration completed for orders in 9.84 seconds
2025-07-19 12:02:29,798 - migrate - INFO - Migration complete. Success: 3, Failed: 0
2025-07-19 12:02:29,799 - migrate - INFO - Starting migration verification...
2025-07-19 12:02:32,918 - migrate - INFO - Verification OK for users: 1100/1100 documents (100.00%)
2025-07-19 12:02:33,534 - migrate - INFO - Verification OK for orders: 1004/1004 documents (100.00%)
2025-07-19 12:02:34,165 - migrate - INFO - Verification OK for agents: 2/2 documents (100.00%)
2025-07-19 12:02:34,172 - migrate - INFO - All collections verified successfully
2025-07-19 12:05:22,506 - migrate - INFO - === MongoDB Migration Tool Starting ===
2025-07-19 12:05:22,507 - migrate - INFO - Validating source database connection...
2025-07-19 12:05:24,492 - migrate - INFO - Validating target database connection...
2025-07-19 12:05:26,363 - migrate - INFO - Database connections validated successfully
2025-07-19 12:05:26,368 - migrate - INFO - Loaded 3 collections for migration
2025-07-19 12:05:26,374 - migrate - INFO - Starting migration with 4 workers
2025-07-19 12:05:26,378 - migrate - INFO - Starting migration for users
2025-07-19 12:05:26,381 - migrate - INFO - Starting migration for orders
2025-07-19 12:05:26,384 - migrate - INFO - Starting migration for agents
2025-07-19 12:05:30,769 - migrate - INFO - Migration completed for users in 4.39 seconds
2025-07-19 12:05:30,795 - migrate - INFO - Migration completed for agents in 4.41 seconds
2025-07-19 12:05:30,801 - migrate - INFO - Migration completed for orders in 4.41 seconds
2025-07-19 12:05:30,804 - migrate - INFO - Migration complete. Success: 3, Failed: 0
2025-07-19 12:05:30,805 - migrate - INFO - Starting migration verification...
2025-07-19 12:05:33,908 - migrate - INFO - Verification OK for users: 1100/1100 documents (100.00%)
2025-07-19 12:05:34,521 - migrate - INFO - Verification OK for orders: 1004/1004 documents (100.00%)
2025-07-19 12:05:35,124 - migrate - INFO - Verification OK for agents: 2/2 documents (100.00%)
2025-07-19 12:05:35,133 - migrate - INFO - All collections verified successfully
2025-07-19 12:12:07,823 - migrate - INFO - === MongoDB Migration Tool Starting ===
2025-07-19 12:12:07,824 - migrate - INFO - Validating source database connection...
2025-07-19 12:12:09,794 - migrate - INFO - Validating target database connection...
2025-07-19 12:12:10,521 - migrate - INFO - Database connections validated successfully
2025-07-19 12:12:10,527 - migrate - INFO - Loaded 3 collections for migration
2025-07-19 12:12:10,532 - migrate - INFO - Starting migration with 4 workers
2025-07-19 12:12:10,536 - migrate - INFO - Starting migration for users
2025-07-19 12:12:10,537 - migrate - INFO - Starting migration for orders
2025-07-19 12:12:10,540 - migrate - INFO - Starting migration for agents
2025-07-19 12:12:14,911 - migrate - INFO - Migration completed for agents in 4.37 seconds
2025-07-19 12:12:14,945 - migrate - INFO - Migration completed for users in 4.41 seconds
2025-07-19 12:12:14,968 - migrate - INFO - Migration completed for orders in 4.43 seconds
2025-07-19 12:12:14,971 - migrate - INFO - Migration complete. Success: 3, Failed: 0
2025-07-19 12:12:14,972 - migrate - INFO - Starting migration verification...
2025-07-19 12:12:18,098 - migrate - INFO - Verification OK for users: 1100/1100 documents (100.00%)
2025-07-19 12:12:18,714 - migrate - INFO - Verification OK for orders: 1004/1004 documents (100.00%)
2025-07-19 12:12:19,335 - migrate - INFO - Verification OK for agents: 2/2 documents (100.00%)
2025-07-19 12:12:19,344 - migrate - INFO - All collections verified successfully
2025-07-19 12:19:18,422 - migrate - INFO - === MongoDB Migration Tool Starting ===
2025-07-19 12:19:18,424 - migrate - INFO - Validating source database connection...
2025-07-19 12:19:20,391 - migrate - INFO - Validating target database connection...
2025-07-19 12:19:22,224 - migrate - INFO - Database connections validated successfully
2025-07-19 12:19:22,230 - migrate - INFO - Loaded 3 collections for migration
2025-07-19 12:19:22,235 - migrate - INFO - Starting migration with 4 workers
2025-07-19 12:19:22,238 - migrate - INFO - Starting migration for users
2025-07-19 12:19:22,238 - migrate - INFO - Starting migration for orders
2025-07-19 12:19:22,239 - migrate - INFO - Starting migration for agents
2025-07-19 12:19:26,581 - migrate - INFO - Migration completed for agents in 4.34 seconds
2025-07-19 12:19:26,727 - migrate - INFO - Migration completed for orders in 4.48 seconds
2025-07-19 12:19:26,804 - migrate - INFO - Migration completed for users in 4.56 seconds
2025-07-19 12:19:26,806 - migrate - INFO - Migration complete. Success: 3, Failed: 0
2025-07-19 12:19:26,807 - migrate - INFO - Running update operation to catch any changed documents...
2025-07-19 12:19:26,808 - migrate - INFO - Starting update operation to sync changed documents
2025-07-19 12:19:26,821 - migrate - INFO - Checking for updates in users
2025-07-19 12:25:07,964 - migrate - INFO - Updated 10 documents in users
2025-07-19 12:25:08,000 - migrate - INFO - Checking for updates in orders
2025-07-19 12:26:00,697 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 12:26:02,037 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 12:26:02,619 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 12:26:02,882 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 12:26:03,109 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 12:26:03,673 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 12:26:04,119 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 12:26:21,260 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 12:26:21,591 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 12:26:22,397 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 12:26:22,645 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 12:26:22,746 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 12:26:22,889 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 12:26:23,098 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 12:26:23,415 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 12:26:23,632 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 12:26:23,799 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 12:26:23,997 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 12:26:24,183 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 12:26:24,368 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 12:26:24,536 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 12:26:24,693 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 12:26:25,223 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 12:26:25,252 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 12:26:25,284 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 12:26:25,316 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 12:26:25,348 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 12:26:25,379 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 12:26:25,412 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 12:26:25,448 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 12:26:25,473 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 12:26:25,503 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 12:26:25,534 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 12:26:25,566 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 12:26:25,599 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 12:26:25,634 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 12:26:25,663 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 12:26:25,695 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 12:26:25,725 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 12:26:25,758 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 12:26:25,789 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 12:26:25,822 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 12:26:25,851 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 12:26:25,882 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 12:26:25,914 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 12:26:25,945 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 12:26:25,977 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 12:26:26,010 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 12:26:26,040 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 12:26:26,079 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 12:26:26,103 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 12:26:26,135 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 12:34:43,710 - migrate - INFO - === MongoDB Migration Tool Starting ===
2025-07-19 12:34:43,712 - migrate - INFO - Validating source database connection...
2025-07-19 12:34:45,700 - migrate - INFO - Validating target database connection...
2025-07-19 12:34:47,512 - migrate - INFO - Database connections validated successfully
2025-07-19 12:34:47,518 - migrate - INFO - Loaded 3 collections for migration
2025-07-19 12:34:47,525 - migrate - INFO - Starting migration verification...
2025-07-19 12:34:50,643 - migrate - INFO - Verification OK for users: 1100/1100 documents (100.00%)
2025-07-19 12:34:51,262 - migrate - INFO - Verification OK for orders: 1004/1004 documents (100.00%)
2025-07-19 12:34:51,870 - migrate - INFO - Verification OK for agents: 2/2 documents (100.00%)
2025-07-19 12:53:21,208 - migrate - INFO - === MongoDB Migration Tool Starting ===
2025-07-19 12:53:21,211 - migrate - INFO - Validating source database connection...
2025-07-19 12:53:23,444 - migrate - INFO - Validating target database connection...
2025-07-19 12:53:25,640 - migrate - INFO - Database connections validated successfully
2025-07-19 12:53:25,650 - migrate - INFO - Loaded 3 collections for migration
2025-07-19 12:53:25,663 - migrate - INFO - Starting migration verification...
2025-07-19 12:53:29,367 - migrate - INFO - Verification OK for users: 1100/1100 documents (100.00%)
2025-07-19 12:53:29,990 - migrate - INFO - Verification OK for orders: 1004/1004 documents (100.00%)
2025-07-19 12:53:30,748 - migrate - INFO - Verification OK for agents: 2/2 documents (100.00%)
2025-07-19 12:54:40,624 - migrate - INFO - === MongoDB Migration Tool Starting ===
2025-07-19 12:54:40,627 - migrate - INFO - Validating source database connection...
2025-07-19 12:54:43,039 - migrate - INFO - Validating target database connection...
2025-07-19 12:54:45,181 - migrate - INFO - Database connections validated successfully
2025-07-19 12:54:45,191 - migrate - INFO - Loaded 3 collections for migration
2025-07-19 12:54:45,203 - migrate - INFO - Starting update operation to sync changed documents
2025-07-19 12:54:45,241 - migrate - INFO - Checking for updates in users
2025-07-19 12:54:47,188 - migrate - INFO - Found 1100 documents in source collection users
2025-07-19 12:54:47,871 - migrate - INFO - Processing batch 1 in users
2025-07-19 12:55:23,277 - migrate - INFO - Processing batch 2 in users
2025-07-19 12:55:59,508 - migrate - INFO - Processing batch 3 in users
2025-07-19 12:56:34,628 - migrate - INFO - Processing batch 4 in users
2025-07-19 12:57:08,465 - migrate - INFO - Processing batch 5 in users
2025-07-19 12:57:43,054 - migrate - INFO - Processing batch 6 in users
2025-07-19 12:58:19,570 - migrate - INFO - Processing batch 7 in users
2025-07-19 12:58:55,533 - migrate - INFO - Processing batch 8 in users
2025-07-19 12:59:32,160 - migrate - INFO - Processing batch 9 in users
2025-07-19 13:00:07,588 - migrate - INFO - Processing batch 10 in users
2025-07-19 13:00:43,601 - migrate - INFO - Processing batch 11 in users
2025-07-19 13:01:19,349 - migrate - INFO - Updated 0 documents in users
2025-07-19 13:01:19,352 - migrate - INFO - Checking for updates in orders
2025-07-19 13:01:19,760 - migrate - INFO - Found 1004 documents in source collection orders
2025-07-19 13:01:19,269 - migrate - INFO - Processing batch 1 in orders
2025-07-19 13:01:54,037 - migrate - INFO - Processing batch 2 in orders
2025-07-19 13:02:28,378 - migrate - INFO - Processing batch 3 in orders
2025-07-19 13:03:04,205 - migrate - INFO - Processing batch 4 in orders
2025-07-19 13:03:40,528 - migrate - INFO - Processing batch 5 in orders
2025-07-19 13:04:16,046 - migrate - INFO - Processing batch 6 in orders
2025-07-19 13:04:49,742 - migrate - INFO - Processing batch 7 in orders
2025-07-19 13:05:23,741 - migrate - INFO - Processing batch 8 in orders
2025-07-19 13:05:57,076 - migrate - INFO - Processing batch 9 in orders
2025-07-19 13:06:31,081 - migrate - INFO - Processing batch 10 in orders
2025-07-19 13:07:05,994 - migrate - INFO - Processing batch 11 in orders
2025-07-19 13:07:07,371 - migrate - INFO - Updated 0 documents in orders
2025-07-19 13:07:07,374 - migrate - INFO - Checking for updates in agents
2025-07-19 13:07:07,727 - migrate - INFO - Found 2 documents in source collection agents
2025-07-19 13:07:08,058 - migrate - INFO - Processing batch 1 in agents
2025-07-19 13:07:08,691 - migrate - INFO - Updated 0 documents in agents
2025-07-19 13:07:08,694 - migrate - INFO - Update operation complete. Total documents updated: 0
2025-07-19 13:22:09,287 - migrate - INFO - === MongoDB Migration Tool Starting ===
2025-07-19 13:22:09,292 - migrate - INFO - Validating source database connection...
2025-07-19 13:22:11,644 - migrate - INFO - Validating target database connection...
2025-07-19 13:22:13,750 - migrate - INFO - Database connections validated successfully
2025-07-19 13:22:13,768 - migrate - INFO - Loaded 3 collections for migration
2025-07-19 13:22:13,779 - migrate - INFO - Starting CDC mode
2025-07-19 13:22:15,794 - migrate - WARNING - Change streams not supported: The $changeStream stage is only supported on replica sets, full error: {'ok': 0.0, 'errmsg': 'The $changeStream stage is only supported on replica sets', 'code': 40573, 'codeName': 'Location40573'}. Falling back to polling mode.
2025-07-19 13:22:15,797 - migrate - INFO - Starting legacy CDC mode with polling
2025-07-19 13:22:15,799 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 13:43:51,656 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 13:44:50,030 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 13:58:55,530 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 14:03:37,284 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 14:03:37,289 - migrate - INFO - CDC mode stopped
2025-07-19 14:03:37,301 - migrate - INFO - CDC mode stopped
2025-07-19 14:43:57,157 - migrate - INFO - === MongoDB Migration Tool Starting ===
2025-07-19 14:43:57,169 - migrate - INFO - Validating source database connection...
2025-07-19 14:43:59,552 - migrate - INFO - Validating target database connection...
2025-07-19 14:44:01,518 - migrate - INFO - Database connections validated successfully
2025-07-19 14:44:01,530 - migrate - INFO - Loaded 3 collections for migration
2025-07-19 14:44:01,543 - migrate - INFO - Starting CDC mode with auto-threading
2025-07-19 14:44:03,565 - migrate - WARNING - Change streams not supported: The $changeStream stage is only supported on replica sets, full error: {'ok': 0.0, 'errmsg': 'The $changeStream stage is only supported on replica sets', 'code': 40573, 'codeName': 'Location40573'}. Falling back to polling mode.
2025-07-19 14:44:03,568 - migrate - INFO - Starting legacy CDC mode with polling in threaded (auto) mode
2025-07-19 14:44:03,569 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 15:13:21,931 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:17:40,561 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:17:41,030 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:17:41,989 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:17:42,580 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:17:42,953 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:17:43,222 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:17:43,381 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:17:43,588 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:17:43,783 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:17:43,945 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:17:44,124 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:17:44,314 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:17:44,487 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:17:44,674 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:17:45,322 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:17:55,504 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:17:55,775 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:17:56,436 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:17:56,696 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:17:56,913 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:32:34,024 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:32:41,731 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:32:43,250 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:32:43,892 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:32:44,433 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:32:44,975 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:32:45,358 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:32:45,703 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:32:45,992 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:32:46,253 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:43:47,186 - migrate - INFO - === MongoDB Migration Tool Starting ===
2025-07-19 15:43:47,190 - migrate - INFO - Validating source database connection...
2025-07-19 15:43:49,277 - migrate - INFO - Validating target database connection...
2025-07-19 15:43:51,212 - migrate - INFO - Database connections validated successfully
2025-07-19 15:43:51,216 - migrate - INFO - Loaded 3 collections for migration
2025-07-19 15:43:51,221 - migrate - INFO - Starting CDC mode with auto-threading
2025-07-19 15:43:51,632 - migrate - WARNING - Change streams not supported: The $changeStream stage is only supported on replica sets, full error: {'ok': 0.0, 'errmsg': 'The $changeStream stage is only supported on replica sets', 'code': 40573, 'codeName': 'Location40573'}. Falling back to polling mode.
2025-07-19 15:43:51,634 - migrate - INFO - Starting legacy CDC mode with polling in threaded (auto) mode
2025-07-19 15:43:51,635 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 15:45:54,787 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:45:53,783 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:45:54,240 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:45:54,772 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:45:55,283 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:45:55,723 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:45:56,207 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:45:56,529 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:45:57,885 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:45:58,296 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:45:58,640 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:45:58,855 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:45:59,064 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:45:59,256 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:45:59,424 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:45:59,643 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:45:59,815 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:46:00,008 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:46:00,207 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:46:00,420 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:46:00,635 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:46:00,821 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:46:01,048 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:46:01,268 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:46:01,452 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:54,782 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:55,010 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:55,192 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:55,359 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:55,533 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:55,695 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:55,871 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:56,063 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:56,597 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:56,628 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:56,661 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:56,692 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:56,725 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:56,756 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:56,788 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:56,820 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:56,865 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:56,900 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:56,930 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:56,963 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:56,995 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:57,025 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:57,059 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:57,091 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:57,123 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:57,155 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:57,189 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:57,221 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:57,252 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:57,288 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:57,320 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:57,352 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:57,384 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:57,418 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:57,452 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:57,485 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:57,516 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:57,547 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:57,577 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:57,608 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:56,043 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:56,074 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:56,107 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:56,139 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:56,171 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:56,202 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:56,233 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:56,266 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:56,297 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:56,336 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:56,376 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:56,408 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:56,442 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:56,473 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:56,507 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:56,539 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:56,573 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:56,605 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:56,636 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:56,668 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:56,700 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:56,732 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:56,764 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:56,798 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:56,831 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:56,863 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:47:56,895 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:50:30,897 - migrate - INFO - === MongoDB Migration Tool Starting ===
2025-07-19 15:50:30,900 - migrate - INFO - Validating source database connection...
2025-07-19 15:50:31,290 - migrate - INFO - Validating target database connection...
2025-07-19 15:50:33,269 - migrate - INFO - Database connections validated successfully
2025-07-19 15:50:33,274 - migrate - INFO - Loaded 3 collections for migration
2025-07-19 15:50:33,280 - migrate - INFO - Starting CDC mode
2025-07-19 15:50:35,195 - migrate - WARNING - Change streams not supported: The $changeStream stage is only supported on replica sets, full error: {'ok': 0.0, 'errmsg': 'The $changeStream stage is only supported on replica sets', 'code': 40573, 'codeName': 'Location40573'}. Falling back to polling mode.
2025-07-19 15:50:35,196 - migrate - INFO - Starting legacy CDC mode with polling in sequential mode
2025-07-19 15:50:35,198 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 15:50:50,639 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 15:50:55,665 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 15:51:11,361 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 15:51:16,382 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 15:51:31,812 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 15:51:35,255 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 15:51:52,169 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 15:51:57,180 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 15:52:12,465 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 15:52:17,617 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 15:52:33,351 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 15:52:38,465 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 15:52:55,519 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 15:53:00,597 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 15:53:15,807 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 15:53:20,924 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 15:53:36,646 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 15:53:36,758 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:53:37,649 - migrate - INFO - CDC mode stopped
2025-07-19 15:53:37,654 - migrate - INFO - CDC mode stopped
2025-07-19 15:53:37,846 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:53:49,096 - migrate - INFO - === MongoDB Migration Tool Starting ===
2025-07-19 15:53:49,098 - migrate - INFO - Validating source database connection...
2025-07-19 15:53:51,128 - migrate - INFO - Validating target database connection...
2025-07-19 15:53:52,999 - migrate - INFO - Database connections validated successfully
2025-07-19 15:53:53,007 - migrate - INFO - Loaded 3 collections for migration
2025-07-19 15:53:53,014 - migrate - INFO - Starting CDC mode with auto-threading
2025-07-19 15:53:55,071 - migrate - WARNING - Change streams not supported: The $changeStream stage is only supported on replica sets, full error: {'ok': 0.0, 'errmsg': 'The $changeStream stage is only supported on replica sets', 'code': 40573, 'codeName': 'Location40573'}. Falling back to polling mode.
2025-07-19 15:53:55,073 - migrate - INFO - Starting legacy CDC mode with polling in threaded (auto) mode
2025-07-19 15:53:55,074 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 15:55:28,103 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:55:30,266 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:55:30,523 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:55:30,712 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:55:30,903 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:55:31,103 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:55:31,302 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:55:31,499 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:55:31,680 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:55:31,832 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:55:32,005 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:55:32,162 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:55:32,338 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:55:32,504 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 15:55:32,658 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 17:25:47,176 - migrate - INFO - === MongoDB Migration Tool Starting ===
2025-07-19 17:25:47,181 - migrate - INFO - Validating source database connection...
2025-07-19 17:25:49,287 - migrate - INFO - Validating target database connection...
2025-07-19 17:25:51,180 - migrate - INFO - Database connections validated successfully
2025-07-19 17:25:51,188 - migrate - INFO - Loaded 3 collections for migration
2025-07-19 17:25:51,195 - migrate - INFO - Starting CDC mode
2025-07-19 17:25:53,016 - migrate - WARNING - Change streams not supported: The $changeStream stage is only supported on replica sets, full error: {'ok': 0.0, 'errmsg': 'The $changeStream stage is only supported on replica sets', 'code': 40573, 'codeName': 'Location40573'}. Falling back to polling mode.
2025-07-19 17:25:53,018 - migrate - INFO - Starting legacy CDC mode with polling in sequential mode
2025-07-19 17:25:53,019 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 17:26:07,943 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 17:26:12,945 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 17:26:29,419 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 17:26:34,421 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 17:26:50,864 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 17:26:55,867 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 17:27:13,101 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 17:27:16,927 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 17:27:33,996 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 17:27:39,075 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 17:27:54,245 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 17:27:59,281 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 17:28:16,816 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 17:28:20,630 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 17:28:38,086 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 17:28:43,278 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 17:28:59,256 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 17:29:04,682 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 17:58:24,002 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 17:58:29,005 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 17:58:45,536 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 17:58:50,541 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 17:59:07,281 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 17:59:12,283 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 17:59:29,679 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 17:59:34,986 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 17:59:51,192 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 17:59:56,417 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:00:13,782 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:00:18,784 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:00:36,624 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:00:41,651 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:00:57,650 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:01:02,906 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:01:18,928 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:01:24,246 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:01:41,678 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:01:45,449 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:02:04,598 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:02:09,659 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:02:27,073 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:02:32,092 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:02:49,433 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:02:54,647 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:03:13,799 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:03:17,556 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:03:36,117 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:03:41,121 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:03:58,765 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:04:03,767 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:04:22,116 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:04:27,118 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:04:46,006 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:04:51,008 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:05:09,043 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:05:14,045 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:05:32,227 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:05:37,228 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:05:55,057 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:06:00,088 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:06:19,185 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:06:24,207 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:06:41,844 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:06:46,846 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:07:07,747 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:07:12,750 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:07:31,496 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:07:36,499 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:07:55,640 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:08:00,643 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:08:19,413 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:08:24,416 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:08:43,283 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:08:48,286 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:09:04,131 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:09:09,135 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:09:31,242 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:09:36,246 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:09:55,566 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:10:00,570 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:10:20,453 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:10:25,456 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:10:45,214 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:10:50,218 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:11:10,319 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:11:15,323 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:11:21,541 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:11:34,746 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:11:35,219 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:11:35,223 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:11:35,222 - migrate - INFO - CDC mode stopped
2025-07-19 18:11:35,230 - migrate - INFO - CDC mode stopped
2025-07-19 18:11:35,494 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:13:12,526 - migrate - INFO - === MongoDB Migration Tool Starting ===
2025-07-19 18:13:12,532 - migrate - INFO - Validating source database connection...
2025-07-19 18:13:14,826 - migrate - INFO - Validating target database connection...
2025-07-19 18:13:16,893 - migrate - INFO - Database connections validated successfully
2025-07-19 18:13:16,903 - migrate - INFO - Loaded 3 collections for migration
2025-07-19 18:13:16,914 - migrate - INFO - Starting CDC mode
2025-07-19 18:13:18,934 - migrate - WARNING - Change streams not supported: The $changeStream stage is only supported on replica sets, full error: {'ok': 0.0, 'errmsg': 'The $changeStream stage is only supported on replica sets', 'code': 40573, 'codeName': 'Location40573'}. Falling back to polling mode.
2025-07-19 18:13:18,938 - migrate - INFO - Starting legacy CDC mode with polling in sequential mode
2025-07-19 18:13:18,940 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:13:38,228 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:13:43,232 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:14:02,503 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:14:07,506 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:14:26,074 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:14:31,077 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:14:49,747 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:14:54,750 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:15:14,268 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:15:19,272 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:15:38,143 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:15:43,147 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:16:02,960 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:16:07,963 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:16:27,979 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:16:32,982 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:16:51,826 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:16:56,829 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:17:15,370 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:17:20,375 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:17:41,393 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:17:46,396 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:18:04,483 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:18:09,488 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:18:27,477 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:18:32,481 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:18:49,388 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:18:54,394 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:19:11,643 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:19:16,648 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:19:33,576 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:19:38,579 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:19:58,407 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:20:03,418 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:20:23,096 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:20:28,100 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:20:47,243 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:20:52,247 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:21:11,627 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:21:16,631 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:21:36,458 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:21:41,464 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:22:00,638 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:22:05,642 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:22:24,989 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:22:29,992 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:22:49,165 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:22:54,171 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:23:13,170 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:23:18,175 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:23:36,793 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:23:41,796 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:24:05,814 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:24:10,817 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:24:41,244 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:24:46,247 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:25:19,940 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:25:24,944 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:25:58,643 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:26:03,646 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:26:39,010 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:26:44,013 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:27:18,149 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:27:23,155 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:27:56,037 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:28:01,040 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:28:34,560 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:28:39,564 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:29:14,285 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:29:19,288 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:29:45,998 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:29:52,225 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:29:53,088 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:29:53,091 - migrate - INFO - CDC mode stopped
2025-07-19 18:29:53,097 - migrate - INFO - CDC mode stopped
2025-07-19 18:30:51,893 - migrate - INFO - === MongoDB Migration Tool Starting ===
2025-07-19 18:30:51,899 - migrate - INFO - Validating source database connection...
2025-07-19 18:30:54,185 - migrate - INFO - Validating target database connection...
2025-07-19 18:30:56,244 - migrate - INFO - Database connections validated successfully
2025-07-19 18:30:56,254 - migrate - INFO - Loaded 3 collections for migration
2025-07-19 18:30:56,264 - migrate - INFO - Starting CDC mode
2025-07-19 18:30:58,486 - migrate - WARNING - Change streams not supported: The $changeStream stage is only supported on replica sets, full error: {'ok': 0.0, 'errmsg': 'The $changeStream stage is only supported on replica sets', 'code': 40573, 'codeName': 'Location40573'}. Falling back to polling mode.
2025-07-19 18:30:58,489 - migrate - INFO - Starting legacy CDC mode with polling in sequential mode
2025-07-19 18:30:58,491 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:31:40,878 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:31:45,882 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:32:27,000 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:32:27,515 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:32:28,061 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:32:28,485 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:32:28,933 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:32:30,436 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:32:30,438 - migrate - INFO - CDC mode stopped
2025-07-19 18:32:30,442 - migrate - INFO - CDC mode stopped
2025-07-19 18:32:30,458 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:50:31,418 - migrate - INFO - === MongoDB Migration Tool Starting ===
2025-07-19 18:50:31,426 - migrate - INFO - Validating source database connection...
2025-07-19 18:50:33,768 - migrate - INFO - Validating target database connection...
2025-07-19 18:50:35,725 - migrate - INFO - Database connections validated successfully
2025-07-19 18:50:35,736 - migrate - INFO - Loaded 3 collections for migration
2025-07-19 18:50:35,746 - migrate - INFO - Starting migration with 4 workers
2025-07-19 18:50:35,762 - migrate - INFO - Starting migration for users
2025-07-19 18:50:35,765 - migrate - INFO - Starting migration for orders
2025-07-19 18:50:35,774 - migrate - INFO - Starting migration for agents
2025-07-19 18:50:40,415 - migrate - INFO - Migration completed for users in 4.64 seconds
2025-07-19 18:50:40,419 - migrate - INFO - Migration completed for agents in 4.63 seconds
2025-07-19 18:50:41,360 - migrate - INFO - Migration completed for orders in 5.58 seconds
2025-07-19 18:50:41,365 - migrate - INFO - Migration complete. Success: 3, Failed: 0
2025-07-19 18:50:41,369 - migrate - INFO - Running update operation to catch any changed documents...
2025-07-19 18:50:41,382 - migrate - INFO - Starting update operation to sync changed documents
2025-07-19 18:50:41,428 - migrate - INFO - Checking for updates in users
2025-07-19 18:50:43,493 - migrate - INFO - Found 0 documents in source collection users
2025-07-19 18:50:43,898 - migrate - INFO - Updated 0 documents in users
2025-07-19 18:50:43,901 - migrate - INFO - Checking for updates in orders
2025-07-19 18:50:44,201 - migrate - INFO - Found 22 documents in source collection orders
2025-07-19 18:50:44,560 - migrate - INFO - Processing batch 1 in orders
2025-07-19 18:50:53,522 - migrate - INFO - Updated 0 documents in orders
2025-07-19 18:50:53,525 - migrate - INFO - Checking for updates in agents
2025-07-19 18:50:53,832 - migrate - INFO - Found 0 documents in source collection agents
2025-07-19 18:50:54,137 - migrate - INFO - Updated 0 documents in agents
2025-07-19 18:50:54,140 - migrate - INFO - Update operation complete. Total documents updated: 0
2025-07-19 18:50:54,142 - migrate - INFO - Starting migration verification...
2025-07-19 18:50:57,529 - migrate - INFO - Verification MISMATCH for users: 0/0 documents (0.00%)
2025-07-19 18:50:58,246 - migrate - INFO - Verification OK for orders: 22/22 documents (100.00%)
2025-07-19 18:50:58,861 - migrate - INFO - Verification MISMATCH for agents: 0/0 documents (0.00%)
2025-07-19 18:50:58,874 - migrate - WARNING - 2 collections failed verification
2025-07-19 18:50:58,922 - migrate - INFO - Migration report generated: reports/migrate_20250719_185058.html
2025-07-19 18:52:28,514 - migrate - INFO - === MongoDB Migration Tool Starting ===
2025-07-19 18:52:28,518 - migrate - INFO - Validating source database connection...
2025-07-19 18:52:30,793 - migrate - INFO - Validating target database connection...
2025-07-19 18:52:32,952 - migrate - INFO - Database connections validated successfully
2025-07-19 18:52:32,961 - migrate - INFO - Loaded 3 collections for migration
2025-07-19 18:52:32,970 - migrate - INFO - Starting update operation to sync changed documents
2025-07-19 18:52:33,001 - migrate - INFO - Checking for updates in users
2025-07-19 18:52:34,996 - migrate - INFO - Found 0 documents in source collection users
2025-07-19 18:52:35,413 - migrate - INFO - Updated 0 documents in users
2025-07-19 18:52:35,415 - migrate - INFO - Checking for updates in orders
2025-07-19 18:52:35,725 - migrate - INFO - Found 22 documents in source collection orders
2025-07-19 18:52:36,025 - migrate - INFO - Processing batch 1 in orders
2025-07-19 18:52:44,330 - migrate - INFO - Updated 0 documents in orders
2025-07-19 18:52:44,333 - migrate - INFO - Checking for updates in agents
2025-07-19 18:52:44,640 - migrate - INFO - Found 0 documents in source collection agents
2025-07-19 18:52:44,944 - migrate - INFO - Updated 0 documents in agents
2025-07-19 18:52:44,947 - migrate - INFO - Update operation complete. Total documents updated: 0
2025-07-19 18:53:24,707 - migrate - INFO - === MongoDB Migration Tool Starting ===
2025-07-19 18:53:24,710 - migrate - INFO - Validating source database connection...
2025-07-19 18:53:26,931 - migrate - INFO - Validating target database connection...
2025-07-19 18:53:29,074 - migrate - INFO - Database connections validated successfully
2025-07-19 18:53:29,083 - migrate - INFO - Loaded 3 collections for migration
2025-07-19 18:53:29,093 - migrate - INFO - Starting CDC mode
2025-07-19 18:53:31,227 - migrate - WARNING - Change streams not supported: The $changeStream stage is only supported on replica sets, full error: {'ok': 0.0, 'errmsg': 'The $changeStream stage is only supported on replica sets', 'code': 40573, 'codeName': 'Location40573'}. Falling back to polling mode.
2025-07-19 18:53:31,229 - migrate - INFO - Starting legacy CDC mode with polling in sequential mode
2025-07-19 18:53:31,231 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:54:00,100 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:54:00,994 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:54:01,445 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:54:01,730 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:54:02,009 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:54:03,500 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:54:04,200 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:54:04,473 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:54:04,666 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:54:04,906 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:54:05,085 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:54:05,287 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:54:05,485 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:54:06,236 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:54:06,489 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:54:06,693 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:54:06,908 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:54:07,128 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:54:07,358 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:54:07,586 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:54:07,962 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:54:08,198 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:54:08,842 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:54:09,159 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:54:09,477 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:54:09,716 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:54:09,920 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:54:10,303 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:54:10,896 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:54:10,970 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 18:54:10,972 - migrate - INFO - CDC mode stopped
2025-07-19 18:54:10,974 - migrate - INFO - CDC mode stopped
2025-07-19 18:54:11,124 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:54:11,269 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:55:32,421 - migrate - INFO - === MongoDB Migration Tool Starting ===
2025-07-19 18:55:32,425 - migrate - INFO - Validating source database connection...
2025-07-19 18:55:34,489 - migrate - INFO - Validating target database connection...
2025-07-19 18:55:36,343 - migrate - INFO - Database connections validated successfully
2025-07-19 18:55:36,350 - migrate - INFO - Loaded 3 collections for migration
2025-07-19 18:55:36,360 - migrate - INFO - Starting CDC mode with auto-threading
2025-07-19 18:55:38,205 - migrate - WARNING - Change streams not supported: The $changeStream stage is only supported on replica sets, full error: {'ok': 0.0, 'errmsg': 'The $changeStream stage is only supported on replica sets', 'code': 40573, 'codeName': 'Location40573'}. Falling back to polling mode.
2025-07-19 18:55:38,208 - migrate - INFO - Starting legacy CDC mode with polling in threaded (auto) mode
2025-07-19 18:55:38,210 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 18:58:47,523 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:58:48,019 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:58:48,699 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:58:49,926 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:58:50,450 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:58:50,759 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:58:50,996 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:58:51,248 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:58:51,519 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:58:51,781 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:58:51,987 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:58:53,394 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:58:53,859 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:58:57,481 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:58:57,816 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:58:58,128 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:58:58,358 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:58:58,567 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:58:58,771 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:58:58,970 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:58:59,145 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:58:59,340 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:58:59,511 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:58:59,712 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:58:59,915 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:00,114 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:00,326 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:00,520 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:00,712 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:00,893 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:01,100 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:01,306 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:01,520 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:01,727 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:01,927 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:02,145 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:02,777 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:03,287 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:03,316 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:03,348 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:03,380 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:03,411 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:03,442 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:03,472 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:03,505 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:03,545 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:03,574 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:03,599 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:03,637 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:03,665 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:03,702 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:03,728 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:03,761 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:03,786 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:03,827 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:03,850 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:03,898 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:03,918 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:03,952 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:03,984 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:04,018 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:04,052 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:04,082 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:04,114 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:04,141 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:04,170 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:04,203 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:04,235 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:04,265 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:04,297 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:17,419 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:17,685 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:17,888 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:18,100 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:18,339 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:18,512 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:18,703 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:18,966 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:19,198 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:19,474 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:19,690 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:19,875 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:20,070 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:20,271 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:30,668 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:30,903 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:31,141 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:31,440 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:31,813 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:32,107 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:32,328 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:32,500 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:32,673 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:32,846 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:33,822 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:34,221 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:34,400 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:34,558 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:34,736 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:34,953 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:35,156 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:35,352 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:35,595 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:39,933 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:40,220 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:40,572 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 18:59:40,825 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 19:01:21,838 - migrate - INFO - === MongoDB Migration Tool Starting ===
2025-07-19 19:01:21,842 - migrate - INFO - Validating source database connection...
2025-07-19 19:01:23,898 - migrate - INFO - Validating target database connection...
2025-07-19 19:01:25,748 - migrate - INFO - Database connections validated successfully
2025-07-19 19:01:25,757 - migrate - INFO - Loaded 3 collections for migration
2025-07-19 19:01:25,768 - migrate - INFO - Starting migration verification...
2025-07-19 19:01:28,988 - migrate - INFO - Verification MISMATCH for users: 0/0 documents (0.00%)
2025-07-19 19:01:29,608 - migrate - INFO - Verification MISMATCH for orders: 22/32 documents (68.75%)
2025-07-19 19:01:30,238 - migrate - INFO - Verification MISMATCH for agents: 0/0 documents (0.00%)
2025-07-19 19:02:05,131 - migrate - INFO - === MongoDB Migration Tool Starting ===
2025-07-19 19:02:05,134 - migrate - INFO - Validating source database connection...
2025-07-19 19:02:07,094 - migrate - INFO - Validating target database connection...
2025-07-19 19:02:09,040 - migrate - INFO - Database connections validated successfully
2025-07-19 19:02:09,049 - migrate - INFO - Loaded 3 collections for migration
2025-07-19 19:02:09,122 - migrate - INFO - Starting CDC mode with auto-threading
2025-07-19 19:02:11,128 - migrate - WARNING - Change streams not supported: The $changeStream stage is only supported on replica sets, full error: {'ok': 0.0, 'errmsg': 'The $changeStream stage is only supported on replica sets', 'code': 40573, 'codeName': 'Location40573'}. Falling back to polling mode.
2025-07-19 19:02:11,133 - migrate - INFO - Starting legacy CDC mode with polling in threaded (auto) mode
2025-07-19 19:02:11,134 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 19:09:44,106 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 19:09:44,751 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 19:09:45,297 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 19:09:45,805 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 19:09:46,339 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 19:09:46,815 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 19:09:47,199 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 19:09:47,609 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 19:09:47,886 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 19:09:48,154 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 19:09:48,377 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 19:09:48,529 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 19:09:48,689 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 19:09:48,859 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 19:09:49,009 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 19:09:49,156 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 19:09:49,331 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 19:09:49,488 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 19:09:49,651 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 19:09:49,817 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 19:09:50,011 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 19:09:52,140 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 19:09:52,914 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 19:09:53,487 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 19:09:53,825 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 19:09:54,043 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 19:09:54,245 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 19:09:54,441 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 19:09:54,639 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 19:09:54,833 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 19:09:54,989 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 19:09:55,194 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 19:09:55,352 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 19:09:55,527 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 19:10:28,456 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 19:10:28,988 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 19:10:29,900 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 19:10:30,479 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 19:10:30,884 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 19:10:31,151 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 19:10:31,336 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 19:10:31,543 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 19:10:31,723 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 19:10:31,899 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 19:10:32,088 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 20:08:44,931 - migrate - INFO - === MongoDB Migration Tool Starting ===
2025-07-19 20:08:44,937 - migrate - INFO - Validating source database connection...
2025-07-19 20:08:47,220 - migrate - INFO - Validating target database connection...
2025-07-19 20:08:49,417 - migrate - INFO - Database connections validated successfully
2025-07-19 20:08:49,448 - migrate - INFO - Loaded 3 collections for migration
2025-07-19 20:08:49,458 - migrate - INFO - Starting CDC mode with auto-threading
2025-07-19 20:08:51,362 - migrate - WARNING - Change streams not supported: The $changeStream stage is only supported on replica sets, full error: {'ok': 0.0, 'errmsg': 'The $changeStream stage is only supported on replica sets', 'code': 40573, 'codeName': 'Location40573'}. Falling back to polling mode.
2025-07-19 20:08:51,364 - migrate - INFO - Starting legacy CDC mode with polling in threaded (auto) mode
2025-07-19 20:08:51,367 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 20:15:19,556 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 20:15:19,861 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 20:15:20,212 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 20:15:20,587 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 20:15:20,900 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 20:15:21,119 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 20:15:21,283 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 20:15:21,457 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 20:15:21,599 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 20:15:21,747 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 20:15:21,888 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 20:15:22,141 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 20:15:22,387 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 20:16:31,056 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 20:16:31,224 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 20:16:31,385 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 20:16:31,547 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 20:16:31,738 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 20:21:19,111 - migrate - INFO - === MongoDB Migration Tool Starting ===
2025-07-19 20:21:19,116 - migrate - INFO - Validating source database connection...
2025-07-19 20:21:21,281 - migrate - INFO - Validating target database connection...
2025-07-19 20:21:23,069 - migrate - INFO - Database connections validated successfully
2025-07-19 20:21:23,077 - migrate - INFO - Loaded 3 collections for migration
2025-07-19 20:21:23,087 - migrate - INFO - Starting CDC mode with auto-threading
2025-07-19 20:21:24,877 - migrate - WARNING - Change streams not supported: The $changeStream stage is only supported on replica sets, full error: {'ok': 0.0, 'errmsg': 'The $changeStream stage is only supported on replica sets', 'code': 40573, 'codeName': 'Location40573'}. Falling back to polling mode.
2025-07-19 20:21:24,880 - migrate - INFO - Starting legacy CDC mode with polling in threaded (auto) mode
2025-07-19 20:21:24,883 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 20:27:12,502 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 20:27:12,973 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 20:27:13,287 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 20:27:13,512 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 20:27:13,716 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 20:27:13,924 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 20:27:14,120 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 20:27:14,331 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 20:27:14,489 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 20:27:14,693 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 20:27:14,871 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 20:27:15,048 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 20:27:15,217 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 20:27:15,380 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 20:27:15,552 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 20:37:49,710 - migrate - INFO - === MongoDB Migration Tool Starting ===
2025-07-19 20:37:49,723 - migrate - INFO - Validating source database connection...
2025-07-19 20:37:51,788 - migrate - INFO - Validating target database connection...
2025-07-19 20:37:53,617 - migrate - INFO - Database connections validated successfully
2025-07-19 20:37:53,629 - migrate - INFO - Loaded 3 collections for migration
2025-07-19 20:37:53,648 - migrate - INFO - Starting CDC mode with auto-threading
2025-07-19 20:37:55,449 - migrate - WARNING - Change streams not supported: The $changeStream stage is only supported on replica sets, full error: {'ok': 0.0, 'errmsg': 'The $changeStream stage is only supported on replica sets', 'code': 40573, 'codeName': 'Location40573'}. Falling back to polling mode.
2025-07-19 20:37:55,451 - migrate - INFO - Starting legacy CDC mode with polling in threaded (auto) mode
2025-07-19 20:37:55,453 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 20:46:09,068 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 20:46:09,458 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 20:46:09,699 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 20:46:09,911 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 20:46:10,122 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 20:46:10,360 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 20:46:10,602 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 20:46:10,870 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 20:53:15,793 - migrate - INFO - === MongoDB Migration Tool Starting ===
2025-07-19 20:53:15,798 - migrate - INFO - Validating source database connection...
2025-07-19 20:53:17,814 - migrate - INFO - Validating target database connection...
2025-07-19 20:53:19,652 - migrate - INFO - Database connections validated successfully
2025-07-19 20:53:19,660 - migrate - INFO - Loaded 3 collections for migration
2025-07-19 20:53:19,669 - migrate - INFO - Starting CDC mode with auto-threading
2025-07-19 20:53:21,423 - migrate - WARNING - Change streams not supported: The $changeStream stage is only supported on replica sets, full error: {'ok': 0.0, 'errmsg': 'The $changeStream stage is only supported on replica sets', 'code': 40573, 'codeName': 'Location40573'}. Falling back to polling mode.
2025-07-19 20:53:21,425 - migrate - INFO - Starting legacy CDC mode with polling in threaded (auto) mode
2025-07-19 20:53:21,427 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 21:03:26,646 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 21:03:26,933 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 21:03:27,330 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 21:03:27,605 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 21:03:27,917 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 21:03:28,189 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 21:03:33,808 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 21:05:31,460 - migrate - INFO - === MongoDB Migration Tool Starting ===
2025-07-19 21:05:31,462 - migrate - INFO - Validating source database connection...
2025-07-19 21:05:33,339 - migrate - INFO - Validating target database connection...
2025-07-19 21:05:35,234 - migrate - INFO - Database connections validated successfully
2025-07-19 21:05:35,240 - migrate - INFO - Loaded 3 collections for migration
2025-07-19 21:05:35,246 - migrate - INFO - Starting CDC mode
2025-07-19 21:05:37,068 - migrate - WARNING - Change streams not supported: The $changeStream stage is only supported on replica sets, full error: {'ok': 0.0, 'errmsg': 'The $changeStream stage is only supported on replica sets', 'code': 40573, 'codeName': 'Location40573'}. Falling back to polling mode.
2025-07-19 21:05:37,070 - migrate - INFO - Starting legacy CDC mode with polling in sequential mode
2025-07-19 21:05:37,071 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 21:08:02,508 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 21:08:07,531 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 21:10:32,964 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 21:10:37,966 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 21:13:05,120 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 21:13:10,141 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 21:15:33,765 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 21:15:38,770 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 21:18:04,748 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-19 21:18:09,756 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-19 21:19:59,125 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 21:19:59,647 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 21:20:00,005 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 21:20:00,492 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 21:20:00,959 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 21:20:01,324 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 21:20:01,627 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 21:20:01,834 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-19 21:20:02,005 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-20 08:42:09,154 - migrate - INFO - === MongoDB Migration Tool Starting ===
2025-07-20 08:42:09,157 - migrate - INFO - Validating source database connection...
2025-07-20 08:42:11,094 - migrate - INFO - Validating target database connection...
2025-07-20 08:42:12,910 - migrate - INFO - Database connections validated successfully
2025-07-20 08:42:12,915 - migrate - INFO - Loaded 3 collections for migration
2025-07-20 08:42:12,920 - migrate - INFO - Starting CDC mode
2025-07-20 08:42:14,723 - migrate - WARNING - Change streams not supported: The $changeStream stage is only supported on replica sets, full error: {'ok': 0.0, 'errmsg': 'The $changeStream stage is only supported on replica sets', 'code': 40573, 'codeName': 'Location40573'}. Falling back to polling mode.
2025-07-20 08:42:14,725 - migrate - INFO - Starting legacy CDC mode with polling in sequential mode
2025-07-20 08:42:14,726 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-20 08:44:42,598 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-20 08:44:47,601 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-20 08:45:57,531 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-20 08:46:52,496 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-20 08:47:13,209 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-20 08:47:13,211 - migrate - INFO - CDC mode stopped
2025-07-20 08:47:13,216 - migrate - INFO - CDC mode stopped
2025-07-20 08:47:13,220 - migrate - INFO - Generating CDC report...
2025-07-20 08:47:17,644 - migrate - INFO - CDC report generated successfully
2025-07-20 08:47:18,384 - migrate - INFO - === MongoDB Migration Tool Starting ===
2025-07-20 08:47:18,386 - migrate - INFO - Validating source database connection...
2025-07-20 08:47:20,422 - migrate - INFO - Validating target database connection...
2025-07-20 08:47:22,380 - migrate - INFO - Database connections validated successfully
2025-07-20 08:47:22,384 - migrate - INFO - Loaded 3 collections for migration
2025-07-20 08:47:22,388 - migrate - INFO - Starting CDC mode
2025-07-20 08:47:24,304 - migrate - WARNING - Change streams not supported: The $changeStream stage is only supported on replica sets, full error: {'ok': 0.0, 'errmsg': 'The $changeStream stage is only supported on replica sets', 'code': 40573, 'codeName': 'Location40573'}. Falling back to polling mode.
2025-07-20 08:47:24,305 - migrate - INFO - Starting legacy CDC mode with polling in sequential mode
2025-07-20 08:47:24,307 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-20 08:49:51,640 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-20 08:49:56,651 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-20 08:52:32,198 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-20 08:52:37,201 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-20 08:55:16,610 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-20 08:55:21,615 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-20 08:58:14,686 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-20 08:58:19,690 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-20 09:01:13,322 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-20 09:01:18,327 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-20 09:02:29,414 - migrate - INFO - Shutdown requested. Completing current batch before exiting...
2025-07-20 09:02:51,075 - migrate - INFO - === MongoDB Migration Tool Starting ===
2025-07-20 09:02:51,080 - migrate - INFO - Validating source database connection...
2025-07-20 09:02:53,169 - migrate - INFO - Validating target database connection...
2025-07-20 09:02:55,115 - migrate - INFO - Database connections validated successfully
2025-07-20 09:02:55,125 - migrate - INFO - Loaded 3 collections for migration
2025-07-20 09:02:55,134 - migrate - INFO - Starting CDC mode with auto-threading
2025-07-20 09:02:57,152 - migrate - WARNING - Change streams not supported: The $changeStream stage is only supported on replica sets, full error: {'ok': 0.0, 'errmsg': 'The $changeStream stage is only supported on replica sets', 'code': 40573, 'codeName': 'Location40573'}. Falling back to polling mode.
2025-07-20 09:02:57,155 - migrate - INFO - Starting legacy CDC mode with polling in threaded (auto) mode
2025-07-20 09:02:57,158 - migrate - INFO - Running CDC sync for 3 collections in test
2025-07-20 09:04:05,217 - migrate - INFO - CDC cycle complete, sleeping before next sync
2025-07-20 09:04:05,220 - migrate - INFO - CDC mode stopped
2025-07-20 09:04:05,227 - migrate - INFO - CDC mode stopped
2025-07-20 09:04:05,234 - migrate - INFO - Generating CDC report...
2025-07-20 09:04:09,688 - migrate - INFO - CDC report generated successfully
2025-07-20 09:12:12,490 - migrate - INFO - === MongoDB Migration Tool Starting ===
2025-07-20 09:12:12,494 - migrate - INFO - Validating source database connection...
2025-07-20 09:12:14,630 - migrate - INFO - Validating target database connection...
2025-07-20 09:12:16,426 - migrate - INFO - Database connections validated successfully
2025-07-20 09:12:16,437 - migrate - INFO - Loaded 3 collections for migration
2025-07-20 09:12:16,448 - migrate - INFO - Starting CDC mode with auto-threading
2025-07-20 09:12:18,352 - migrate - WARNING - Change streams not supported: The $changeStream stage is only supported on replica sets, full error: {'ok': 0.0, 'errmsg': 'The $changeStream stage is only supported on replica sets', 'code': 40573, 'codeName': 'Location40573'}. Falling back to polling mode.
2025-07-20 09:12:18,354 - migrate - INFO - Starting legacy CDC mode with polling in threaded (auto) mode
2025-07-20 09:12:18,360 - migrate - INFO - Running CDC sync for 3 collections in test
